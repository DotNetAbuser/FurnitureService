@page "/requests"

@inject IRequestManager RequestManager
@inject IJSRuntime JsRuntime

@rendermode InteractiveAuto

<table class="table table-dark">
    <thead>
    <tr>
        <th scope="col">Название мебели</th>
        <th scope="col">Описание проблемы</th>
        <th scope="col">Статус</th>
    </tr>
    </thead>
    <tbody>
    @foreach (var request in requestList)
    {
        <tr>
            <td>@request.Furniture</td>
            <td>@request.Description</td>
            <td>@request.Status</td>
        </tr>
    }
  
    </tbody>
</table>
<button @onclick="LoadDataAsync">Обновить список</button>
@code {
    private List<FurnitureResponse> requestList = [];

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        await LoadDataAsync();
    }

    private async Task LoadDataAsync()
    {
        var result = await RequestManager.GetAllAsync();
        if (!result.Succeeded)
        {
            foreach (var message in result.Messages)
                await JsRuntime.InvokeVoidAsync("alert", message);
            return;
        }

        requestList = [..result.Data];
    }

}